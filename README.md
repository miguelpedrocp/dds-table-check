# DDS ADS Template
See our [Confluence page](https://livesport.atlassian.net/wiki/spaces/DSIK/pages/2788852195/Internal+Pages) for best practice on Git, Snowflake and data science.

**From this template, you will need to change naming conventions so that it is specific to your project. You will need to change: this README, the logging output file name `logging_config_utils.py`, add the correct details to `config.yaml`, ensure you update `requirements.txt` using `pip freeze > path/to/requirements/requirements.txt`, add your files and remove any template files not needed.**

## Project Background
Each live project should have a brief project background.

This is the template for DDS ADS, which provides the key elements of a data science project:
* structure
* logging
* requirements.
* Python files

This code base is managed by the Data and Decision Science team. 

Each project should have a requirements.txt (if using Python) which can be generated by running pip freeze > path/to/requirements/requirements.txt in the terminal.

For those very big projects that are composed by different parts, each of those can be included as component:
```
│
├── main.py
├── config.py
└── /src
    └── /components
        └── /clean_stage
        │    ├── clean_stage.py
        │    ├── /utils
        │    │    └── utils.py
        │    └── /src
        │        └── /sql_queries
        └── /training
            ├── training.py
            ├── /utils
            │    └── utils.py
            └── /src
                └── /sql_queries
```         

For instance let's assume a ML project that includes two main parts:
- cleaning stage
- training stage

## Getting Started
Each live project should have a Getting Started guide so anyone can contribute. Nearly every project should start with:

To start, you need to install required packages by running `pip install -r requirements/requirements.txt`.

Then, run the `main.py` script which calls ... 

## Schedule
Detail when the model or data products are run in automation. Specify the cron expression (e.g., `0 0 11 * * ?`).

## Config
* `config.yaml` provides amongst other things, connections to data sources.

```yaml
DATABASE:
    SNOWFLAKE_ACCOUNT: "si44367.eu-central-1" # account that is used by our team
    SNOWFLAKE_WAREHOUSE : "DS_DEV_WH" # warehouse that is used by our team
    SNOWFLAKE_DATABASE : "DS_DEV" # database that is used by our team
    SNOWFLAKE_SCHEMA: "SCHEMA_NAME" # schema that is used for this project (raise a ticket to create it)
    SNOWFLAKE_ROLE: "DS_DEV_TEAM_ROLE" 
S3:
    BUCKET_NAME: "415280201047-dazn-domino-name_owner-sandbox" # S3 BUCKET
```

* `logging_config.yaml` includes the logging configuration.

```yaml
version: 1
formatters:
  long:   
    format: '%(asctime)s|%(levelname)s|%(name)s|%(filename)s|%(funcName)s|%(message)s' 
  brief: 
    format: '%(levelname)s|%(name)s|%(filename)s|%(funcName)s|%(message)s' 
handlers:
  console:
    class: logging.StreamHandler
    level: DEBUG
    formatter: brief
    stream: ext://sys.stdout
  S3:
    class: logging.StreamHandler
    level: DEBUG
    formatter: long
loggers:
  __main__:
    level: DEBUG
    propagate: yes
  utils.logging_config_utils:
    level: DEBUG
    propagate: yes  
root:
  level: INFO
  handlers: [console,S3]
```

* `.env` includes strictly confidential credentials.

```
SNOWFLAKE_USER=DEV_USERNAME # user name in the following format DEV_{$firstname}_{$lastname}
SNOWFLAKE_PASSWORD=password # your password associated with the snowflake account
AccessKeyID= S3 Access key # temporary S3 access key
SecretAccessKey= S3 Secret Access Key # temporary S3 secret key
SessionToken= S3 Session # temporary S3 session token
```


## Outputs
Each live project should have a have a clear list of outputs, with automated scheduling noted. For example:
`table1` has the column structure:
* `col` `VARCHAR`
* `col2` `DATE`

## Confluence
Each live project should have a [Confluence page](https://livesport.atlassian.net/wiki/spaces/DSIK/pages/5365989871/DDS+Tutorials+Style+Guides+and+Requirements). For this project see the the Internal Pages section which contains details on how to structure a Git repo, naming conventions, best code practices and much more.

## Contributors
List the contributors for a project, so people know who to contact.

* Mark Stevenson (@markstevo)
* Oliver Kaus (@oliver-kaus)
* Lorenzo Vitali (@lorenzovitalidazn)
* Fabio Barbazza (@fabiobarbazza)

When updating this template, update the [version log](https://livesport.atlassian.net/wiki/spaces/DSIK/pages/edit-v2/5590089926).  
*Template version 20220111*
